<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Validation Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        input {
            margin: 10px 0;
            padding: 10px;
            width: 300px;
        }
        button {
            padding: 10px 15px;
        }
    </style>
</head>
<body>
    <h2>Email Submission Form</h2>
    <form id="emailForm">
        <label for="email">Enter your email:</label><br>
        <input type="text" id="email" name="email" required placeholder="example.cs.aiml22@gla.ac.in"><br>
        
        <label for="exceptions">Enter exceptions (comma-separated):</label><br>
        <input type="text" id="exceptions" name="exceptions" placeholder="admin@gla.ac.in,test@gla.ac.in"><br>
        
        <button type="submit">Submit</button>
    </form>

    <div id="message"></div>

    <script>
        // Regular allowed parts
        const allowedParts = ['aiml', 'da', 'csf'];

        // Function to create regex for the primary pattern
        function createRegex(allowedParts) {
            const joinedParts = allowedParts.join('|');
            return new RegExp(`^[a-zA-Z0-9._%+-]+\\.cs\\.(${joinedParts})\\d{2}@gla\\.ac\\.in$`);
        }

        const primaryPattern = createRegex(allowedParts);

        // Validate function that checks against exceptions if provided
        function validateEmail(email, exceptions = []) {
            // Check if the exceptions list is provided and if the email is in that list
            if (exceptions.length > 0 && exceptions.includes(email)) {
                return false; // If it's an exception, return false
            }
            // Validate against the primary pattern
            return primaryPattern.test(email);
        }

        // Form submission event listener
        document.getElementById('emailForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            const emailInput = document.getElementById('email').value.trim();
            const exceptionsInput = document.getElementById('exceptions').value.trim();

            // Parse exceptions from input
            const exceptions = exceptionsInput ? exceptionsInput.split(',').map(part => part.trim()) : [];

            // Validate email
            if (validateEmail(emailInput, exceptions)) {
                document.getElementById('message').innerText = "Email is valid! Submission successful.";
                document.getElementById('message').style.color = "green";
                // Here you can add your submission logic, e.g., sending data to a server
            } else {
                document.getElementById('message').innerText = "Invalid email or it's an exception.";
                document.getElementById('message').style.color = "red";
            }
        });
    </script>
</body>
</html>
