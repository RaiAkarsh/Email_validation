<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Validation Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        input {
            margin: 10px 0;
            padding: 10px;
            width: 300px;
        }
        button {
            padding: 10px 15px;
        }
        #adminSection {
            display: none; /* Hidden by default */
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h2>Email Submission Form</h2>
    <form id="emailForm">
        <label for="email">Enter your email:</label><br>
        <input type="text" id="email" name="email" required placeholder="example.cs.aiml22@gla.ac.in"><br>
        
        <button type="submit">Submit</button>
    </form>

    <div id="message"></div>

    <div>
        <h3>Admin Controls</h3>
        <input type="password" id="adminPassword" placeholder="Enter admin password"><br>
        <button id="adminLogin">Login as Admin</button>
    </div>

    <div id="adminSection">
        <h4>Allowed Parts and Exceptions</h4>
        <label for="allowedParts">Allowed Parts (comma-separated):</label><br>
        <input type="text" id="allowedParts" placeholder="aiml, da, csf"><br>

        <label for="exceptions">Exceptions (comma-separated):</label><br>
        <input type="text" id="exceptions" placeholder="admin@gla.ac.in,test@gla.ac.in"><br>
        
        <button id="updateSettings">Update Settings</button>
    </div>

    <script>
        let allowedParts = ['aiml', 'da', 'csf'];
        let exceptions = [];

        // Function to create regex for the primary pattern
        function createRegex(allowedParts) {
            const joinedParts = allowedParts.join('|');
            return new RegExp(`^[a-zA-Z0-9._%+-]+\\.cs\\.(${joinedParts})\\d{2}@gla\\.ac\\.in$`);
        }

        let primaryPattern = createRegex(allowedParts);

        // Validate function
        function validateEmail(email) {
            return primaryPattern.test(email);
        }

        // Handle admin login
        document.getElementById('adminLogin').addEventListener('click', function() {
            const password = document.getElementById('adminPassword').value;
            // Simple password check for demonstration (use proper authentication in production)
            if (password === 'admin123') {
                document.getElementById('adminSection').style.display = 'block';
                document.getElementById('adminPassword').value = ''; // Clear password field
                alert('Admin access granted.');
            } else {
                alert('Invalid admin password');
            }
        });

        // Update allowed parts and exceptions
        document.getElementById('updateSettings').addEventListener('click', function() {
            const allowedPartsInput = document.getElementById('allowedParts').value.trim();
            const exceptionsInput = document.getElementById('exceptions').value.trim();

            // Update allowed parts and exceptions from input
            allowedParts = allowedPartsInput ? allowedPartsInput.split(',').map(part => part.trim()) : [];
            exceptions = exceptionsInput ? exceptionsInput.split(',').map(part => part.trim()) : [];
            
            // Update regex
            primaryPattern = createRegex(allowedParts);
            alert('Settings updated successfully!');
        });

        // Form submission event listener
        document.getElementById('emailForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            const emailInput = document.getElementById('email').value.trim();

            // Validate email
            if (validateEmail(emailInput) && !exceptions.includes(emailInput)) {
                // Prepare data for Google Form submission
                const googleFormURL = 'https://forms.gle/wYLZ7sqTo4exntpz8'; // Replace with your Google Form URL
                const formData = new FormData();
                formData.append('entry.{<div class="Qr7Oae" role="listitem"><div jsmodel="CP1oW" data-params="%.@.[2014317350,&quot;Hello!&quot;,null,2,[[1067871148,[[&quot;Hi&quot;,null,null,null,false],[&quot;Hey&quot;,null,null,null,false],[&quot;Bye&quot;,null,null,null,false]],false,null,null,null,null,null,false,null,[]]],null,null,null,null,null,null,[null,&quot;Hello!&quot;]],&quot;i8&quot;,&quot;i9&quot;,&quot;i10&quot;,false]"><div jscontroller="sWGJ4b" jsaction="EEvAHc:yfX9oc;" jsname="WsjYwc" class="geS5n"><div class="z12JJ"><div class="M4DNQ"><div id="i8" class="HoXoMd D1wxyf RjsPE" role="heading" aria-level="3"><span class="M7eMe">Hello!</span></div><div class="gubaDc OIC90c RjsPE" id="i9"></div></div></div><div jscontroller="UmOCme" jsaction="rcuQ6b:vZc4S;O22p3e:zjh6rb;b2trFe:eVidQc;JIbuQc:RgMCxe(YlCLKb);sPvj8e:d3sQLd;TYy3Ne:RgMCxe;" class="oyXaNc" jsname="GCYh9b"><input type="hidden" name="entry.1067871148_sentinel" jsname="DTMEae"><div jscontroller="eFy6Rc" jsaction="sPvj8e:Gh295d" jsname="cnAzRb"><div class="lLfZXe fnxRtf cNDBpf" jscontroller="wPRNsd" jsshadow="" jsaction="keydown:I481le;JIbuQc:JIbuQc;rcuQ6b:rcuQ6b" jsname="wCJL8" aria-labelledby="i8" aria-describedby="i9 i10" role="radiogroup"><span jsslot="" role="presentation" jsname="bN97Pc" class="H2Gmcc tyNBNd"><div class="SG0AAe"><div class="nWQGrd zwllIb"><label for="i12" class="docssharedWizToggleLabeledContainer ajBQVb N2RpBe"><div class="bzfPab wFGF8"><div class="d7L4fc bJNwt  FXLARc aomaEc ECvBRb"><div id="i12" class="Od2TWd hYsg7c i9xfbb N2RpBe" jscontroller="D8e5bc" jsaction="keydown:I481le;dyRcpb:dyRcpb;click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue; focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventDefault=true); touchcancel:JMtRjd;" jsshadow="" aria-label="Hi" data-value="Hi" role="radio" aria-checked="true" aria-posinset="1" aria-setsize="3" tabindex="0"><div class="x0k1lc MbhUzd"></div><div class="uyywbd"></div><div class="vd3tt"><div class="AB7Lab Id5V1"><div class="rseUEf nQOrEb"></div></div></div></div></div><div class="YEVVod"><div class="ulDsOb"><span dir="auto" class="aDTYNe snByac OvPDhc OIC90c">Hi</span></div></div></div></label></div><div class="nWQGrd zwllIb"><label for="i15" class="docssharedWizToggleLabeledContainer ajBQVb"><div class="bzfPab wFGF8"><div class="d7L4fc bJNwt  FXLARc aomaEc ECvBRb"><div id="i15" class="Od2TWd hYsg7c i9xfbb" jscontroller="D8e5bc" jsaction="keydown:I481le;dyRcpb:dyRcpb;click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue; focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventDefault=true); touchcancel:JMtRjd;" jsshadow="" aria-label="Hey" data-value="Hey" role="radio" aria-checked="false" aria-posinset="2" aria-setsize="3" tabindex="-1"><div class="x0k1lc MbhUzd"></div><div class="uyywbd"></div><div class="vd3tt"><div class="AB7Lab Id5V1"><div class="rseUEf nQOrEb"></div></div></div></div></div><div class="YEVVod"><div class="ulDsOb"><span dir="auto" class="aDTYNe snByac OvPDhc OIC90c">Hey</span></div></div></div></label></div><div class="nWQGrd zwllIb"><label for="i18" class="docssharedWizToggleLabeledContainer ajBQVb"><div class="bzfPab wFGF8"><div class="d7L4fc bJNwt  FXLARc aomaEc ECvBRb"><div id="i18" class="Od2TWd hYsg7c i9xfbb" jscontroller="D8e5bc" jsaction="keydown:I481le;dyRcpb:dyRcpb;click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue; focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventDefault=true); touchcancel:JMtRjd;" jsshadow="" aria-label="Bye" data-value="Bye" role="radio" aria-checked="false" aria-posinset="3" aria-setsize="3" tabindex="-1"><div class="x0k1lc MbhUzd"></div><div class="uyywbd"></div><div class="vd3tt"><div class="AB7Lab Id5V1"><div class="rseUEf nQOrEb"></div></div></div></div></div><div class="YEVVod"><div class="ulDsOb"><span dir="auto" class="aDTYNe snByac OvPDhc OIC90c">Bye</span></div></div></div></label></div></div></span></div></div><div class="Jwjdfe"><div class="dMALK" jsname="YlCLKb"><div role="button" class="uArJ5e UQuaGc kCyAyd" jscontroller="VXdfxd" jsaction="click:cOuCgd; mousedown:UX7yZ; mouseup:lbsD7e; mouseenter:tfO1Yc; mouseleave:JywGue;touchstart:p6p2H; touchmove:FwuNnf; touchend:yfqBxc(preventDefault=true); touchcancel:JMtRjd;focus:AHmuwe; blur:O22p3e; contextmenu:mg9Pef;" jsshadow="" tabindex="0"><div class="Fvio9d MbhUzd" jsname="ksKsZd"></div><div class="e19J0b CeoRYc"></div><span jsslot="" class="l4V7wb Fxmcue"><span class="NPEfkd RveJvd snByac">Clear selection</span></span></div></div></div></div><div jsname="Rfh2Tc" class="SL4Sz" id="i10" role="alert"></div></div></div></div>}', emailInput); // Replace {emailFieldId} with the actual entry ID from your Google Form

                // Submit to Google Form
                fetch(googleFormURL, {
                    method: 'POST',
                    body: formData,
                })
                .then(response => {
                    if (response.ok) {
                        document.getElementById('message').innerText = "Email submitted successfully!";
                        document.getElementById('message').style.color = "green";
                    } else {
                        throw new Error('Network response was not ok');
                    }
                })
                .catch((error) => {
                    console.error('Error:', error);
                    document.getElementById('message').innerText = "There was an error submitting your email.";
                    document.getElementById('message').style.color = "red";
                });
            } else {
                document.getElementById('message').innerText = "Invalid email or it's an exception.";
                document.getElementById('message').style.color = "red";
            }
        });
    </script>
</body>
</html>
